# Docs & Planning Workflow Tests

> 各 10 个测试路径，深度推导测试

---

## Phase A: Documentation (10 cases)

### A01: 新建 API 文档
**场景**: 新增 REST API，需要从零创建文档
**步骤**:
1. 确认 `docs/` 目录结构
2. 创建 `docs/API.md`
3. 使用标准模板 (endpoints, params, responses)
4. 添加代码示例
5. `*sync`

**预期**: 新文档符合规范

---

### A02: 更新过时的代码示例
**场景**: 文档中的代码示例已过时，API 已变更
**步骤**:
1. 识别过时示例位置
2. 检查当前代码实现
3. 更新示例代码
4. 验证示例可执行
5. 更新日期头

**预期**: 示例与代码一致

---

### A03: 修复文档链接
**场景**: 重构后部分内部链接失效
**步骤**:
1. 运行链接检查
2. 识别失效链接列表
3. 更新链接路径
4. 验证所有链接可访问
5. `*sync`

**预期**: 所有链接正常

---

### A04: 添加架构决策记录 (ADR)
**场景**: 做了重要技术决策，需要记录
**步骤**:
1. 创建 `docs/adr/` 目录（如不存在）
2. 创建 `docs/adr/001-选择状态管理.md`
3. 使用 ADR 模板 (Context, Decision, Consequences)
4. 链接到 ARCHITECTURE.md
5. 更新 MEMORY.md

**预期**: 决策可追溯

---

### A05: 同步 SCHEMA 变更到文档
**场景**: 数据库表结构变更，需同步文档
**步骤**:
1. 查看代码中的 schema 变更
2. 更新 `docs/SCHEMA.md`
3. 更新相关的 API 文档
4. 检查 ER 图是否需要更新
5. 创建关联代码 issue (Doc-Code Linkage)

**预期**: 文档与代码同步

---

### A06: 编写新功能规格
**场景**: PM 提出新需求，需要写规格文档
**步骤**:
1. 创建 `docs/specs/feature-x.md`
2. 定义用户故事
3. 列出功能需求
4. 定义验收标准
5. 关联到 GitHub Issue

**预期**: 规格清晰可执行

---

### A07: 更新 README 安装说明
**场景**: 依赖版本升级，安装命令变更
**步骤**:
1. 检查 package.json 变更
2. 更新 README.md 安装步骤
3. 测试安装命令可用
4. 更新 Node/npm 版本要求
5. `*sync`

**预期**: 新用户可正常安装

---

### A08: 国际化文档
**场景**: 项目需要中文文档
**步骤**:
1. 创建 `docs/zh/` 目录
2. 翻译 README.md
3. 翻译核心文档
4. 保持结构与英文一致
5. 添加语言切换链接

**预期**: 中文文档完整

---

### A09: 废弃功能标记
**场景**: 某 API 将被废弃，需要标记
**步骤**:
1. 在 API 文档添加 `@deprecated` 标记
2. 说明废弃原因
3. 提供迁移指南
4. 设置废弃时间线
5. 更新 CHANGELOG

**预期**: 用户清楚迁移路径

---

### A10: 文档版本化
**场景**: 发布新版本，需要保留旧版文档
**步骤**:
1. 创建 `docs/v1/` 目录
2. 复制当前文档
3. 更新主文档为 v2
4. 添加版本选择器
5. 在 README 添加版本说明

**预期**: 多版本文档共存

---

## Phase B: Planning (10 cases)

### B01: 大功能拆分
**场景**: 收到需求 "实现完整的购物车系统"
**步骤**:
1. 分析需求边界
2. 拆分为模块:
   - 购物车 UI
   - 购物车状态管理
   - 购物车 API
   - 购物车持久化
3. 为每个模块创建 issue
4. 标注依赖关系
5. 设置优先级

**预期**: 5-8 个可独立执行的 issues

---

### B02: 技术选型规划
**场景**: 需要选择前端框架
**步骤**:
1. 列出候选方案 (React, Vue, Svelte)
2. 定义评估标准
3. 创建 POC issues
4. 计划评估时间
5. 记录到 MEMORY.md

**预期**: 清晰的评估计划

---

### B03: MVP 范围定义
**场景**: 资源有限，需要定义 MVP
**步骤**:
1. 列出所有功能需求
2. 按价值/复杂度打分
3. 选择核心功能集
4. 创建 MVP milestone
5. 将非核心功能放入 backlog

**预期**: MVP 范围明确

---

### B04: 迭代规划
**场景**: 新 Sprint 开始
**步骤**:
1. `*issue` 查看 backlog
2. 评估团队容量
3. 选择本迭代 issues
4. 分配责任人
5. 设置 sprint milestone

**预期**: Sprint 目标清晰

---

### B05: 依赖分析
**场景**: 功能 A 依赖功能 B 和服务 C
**步骤**:
1. 绘制依赖图
2. 识别关键路径
3. 标记阻塞关系
4. 调整执行顺序
5. 在 issues 中记录依赖

**预期**: 依赖关系可视化

---

### B06: 风险识别
**场景**: 规划高风险功能（支付集成）
**步骤**:
1. 列出潜在风险
2. 评估影响和概率
3. 制定缓解措施
4. 创建风险跟踪 issue
5. 安排 spike/POC

**预期**: 风险有应对计划

---

### B07: 重构规划
**场景**: 技术债务累积，需要重构
**步骤**:
1. 识别问题区域
2. 定义重构目标
3. 拆分为安全步骤
4. 创建重构 issues
5. 安排测试覆盖

**预期**: 渐进式重构计划

---

### B08: 跨团队协作规划
**场景**: 功能需要后端团队配合
**步骤**:
1. 识别接口需求
2. 创建 API 契约文档
3. 创建前后端 issues
4. 建立沟通机制
5. 设置联调时间点

**预期**: 协作计划明确

---

### B09: 紧急需求插入
**场景**: 客户紧急需求需要插入当前迭代
**步骤**:
1. 评估紧急程度
2. 分析对当前计划影响
3. 与现有 issues 比较优先级
4. 调整或交换 issues
5. 更新 sprint 目标

**预期**: 合理调整计划

---

### B10: 长期路线图
**场景**: 规划未来 3 个月的开发路线
**步骤**:
1. 收集业务目标
2. 映射到技术里程碑
3. 创建 milestones
4. 分配到各 sprint
5. 创建 `docs/ROADMAP.md`

**预期**: 路线图可执行

---

## Test Execution Log

| Case | 结果 | 发现问题 |
|------|------|---------|
| A01 | ⚠️ | 无 API 文档模板 |
| A02 | ⚠️ | 无验证示例可执行的方法 |
| A03 | ⚠️ | 无链接检查工具推荐 |
| A04 | ❌ | 无 ADR 规范和流程 |
| A05 | ✅ | Doc-Code Linkage 支持 |
| A06 | ⚠️ | 无 specs/ 规范和模板 |
| A07 | ✅ | - |
| A08 | ❌ | 无多语言文档规范 |
| A09 | ❌ | 无废弃功能标记规范 |
| A10 | ❌ | 无多版本文档规范 |
| B01 | ⚠️ | 无模块拆分具体指导 |
| B02 | ⚠️ | 无选型评估模板/POC 流程 |
| B03 | ❌ | 无 MVP 定义流程 |
| B04 | ⚠️ | 无 milestone 使用指南 |
| B05 | ⚠️ | 无依赖分析具体方法 |
| B06 | ⚠️ | plan.md 有 Risks，但无评估矩阵 |
| B07 | ⚠️ | 无重构专用流程 |
| B08 | ❌ | 无协作规划流程 |
| B09 | ⚠️ | 无优先级调整流程 |
| B10 | ❌ | 无 ROADMAP 规范 |

---

## 问题汇总

### Phase A: Documentation 问题

| # | 问题 | 严重性 | 建议修复 |
|---|------|--------|---------|
| A-1 | 无文档模板 (API, ADR, Spec) | 高 | 添加 templates 目录 |
| A-2 | 无链接/示例验证方法 | 中 | 添加验证工具推荐 |
| A-3 | 无 ADR 流程 | 中 | 添加 ADR section |
| A-4 | 无多语言规范 | 低 | 按需添加 |
| A-5 | 无废弃标记规范 | 低 | 按需添加 |
| A-6 | 无版本化规范 | 低 | 按需添加 |

### Phase B: Planning 问题

| # | 问题 | 严重性 | 建议修复 |
|---|------|--------|---------|
| B-1 | 无大功能拆分指导 | 高 | 添加拆分方法论 |
| B-2 | 无 MVP/优先级框架 | 高 | 添加 MoSCoW 或 RICE |
| B-3 | 无依赖分析方法 | 中 | 添加依赖图指导 |
| B-4 | 无 milestone 使用指南 | 中 | 添加 milestone section |
| B-5 | 无跨团队协作流程 | 低 | 按需添加 |
| B-6 | 无 ROADMAP 规范 | 低 | 按需添加 |

---

## 测试统计

- **总用例**: 20
- **通过**: 2 (10%)
- **警告**: 12 (60%)
- **失败**: 6 (30%)

### 按阶段

| Phase | 通过 | 警告 | 失败 |
|-------|------|------|------|
| A: Docs | 2 | 4 | 4 |
| B: Planning | 0 | 8 | 2 |
